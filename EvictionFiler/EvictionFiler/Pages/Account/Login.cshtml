@page "/"
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model EvictionFiler.Server.Components.Pages.Account.LoginModel
@{
    ViewData["Title"] = "Login - Housing CourtFiler";
}
<head>
    <title>@ViewData["Title"]</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="app.css" />
    <link rel="stylesheet" href="~/css/login.css" asp-append-version="true" />
    <ImportMap />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&display=swap" rel="stylesheet">
</head>
<form method="post" id="loginForm">
    @Html.AntiForgeryToken()
    <div class="d-flex flex-column justify-content-center align-items-center vh-100">
        <div class="card p-5 pb-5 shadow mb-0 border-0 login-container login-card">
            <div class="login-header mb-1">
                <img src="images/PHOTO-2025-06-18-02-45-29.jpg"
                     class="login-logo"
                     alt="Housing CourtFiler logo" />

                <h1 class="login-title">
                    Login to your account
                </h1>
            </div>

            @if (ModelState.ErrorCount > 0)
            {
                <div class="custom-alert text-danger login-error-alert">
                    Invalid username or password.
                </div>
            }

            <div class="mb-3 username-container">
                <label class="form-label body-medium" asp-for="Login.Username" for="emailInput">Username or e-mail <span class="text-danger">*</span></label>
                <input id="emailInput" asp-for="Login.Username" class="form-control form-control-lg form-input text-gray-300 no-outline" placeholder="Username or e-mail" autocomplete="username" aria-label="Email" inputmode="email"
                       autocapitalize="off"
                       spellcheck="false" />
                <span asp-validation-for="Login.Username" class="text-danger"></span>
                
            </div>

            <div class="mb-3 password-container">
                <label class="form-label body-medium" asp-for="Login.Password" for="passwordInput">Password <span class="text-danger">*</span></label>
                <input id="passwordInput" asp-for="Login.Password" type="password"
                       class="form-control form-control-lg form-input text-gray-300 no-outline"
                           placeholder="Password" autocomplete="current-password"
                           aria-label="Password"
                       autocapitalize="off"
                       spellcheck="false" />
                <span asp-validation-for="Login.Password" class="text-danger"></span>
                
            </div>

            <div class="mb-3 text-end">
                <a class="body-bold forgot-password-link">
                    Forgot password?
                </a>
            </div>

            <div class="d-grid login-btn-wrapper">
                <button id="loginBtn"
                        type="submit"
                        asp-page-handler="Submit"
                        class="btn bg-brand-100 title-h4-semi-bold text-white d-flex align-items-center justify-content-center gap-2 no-outline">
                    <span id="btnText">Sign in</span>
                    <span id="spinner" class="spinner-border spinner-border-sm d-none"></span>
                </button>
            </div>
        </div>

       

        <div class="mt-3 text-center">
            <div class="body-medium">
                Don't have an account?
                <a href="/signup" class="text-brand-100 signup-link">
                    Sign Up
                </a>
            </div>
        </div>
    </div>
</form>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/4.0.0/jquery.validate.unobtrusive.min.js"></script>
<script>
    let submitted = false;
    document.getElementById("loginForm").addEventListener("submit", function (e) {
        if (submitted) {
            e.preventDefault();
            return false;
        }

        if (!$(this).valid()) {
            e.preventDefault();
            return false;
        }

        submitted = true;

        const btn = document.getElementById("loginBtn");
        const text = document.getElementById("btnText");
        const spinner = document.getElementById("spinner");

        btn.disabled = true;
        text.textContent = "Signing in...";
        spinner.classList.remove("d-none");
    });
</script>
