@page "/remainder-center"

@using EvictionFiler.Application.DTOs
@using EvictionFiler.Application.DTOs.CalanderDto
@using EvictionFiler.Application.DTOs.CaseHearing
@using EvictionFiler.Application.DTOs.RemainderCenterDto
@using EvictionFiler.Application.Services
@using EvictionFiler.Domain.Entities.Master
@using System.ComponentModel.DataAnnotations
@using System.Linq.Expressions
@using EvictionFiler.Application.DTOs.ApartmentDto
@using EvictionFiler.Application.DTOs.ClientDto
@using EvictionFiler.Application.DTOs.LandLordDto
@using EvictionFiler.Application.DTOs.LegalCaseDto
@using EvictionFiler.Application.DTOs.PaginationDto
@using EvictionFiler.Application.DTOs.TenantDto

@using EvictionFiler.Application.Interfaces.IRepository.MasterRepository
@using EvictionFiler.Application.Interfaces.IServices
@using EvictionFiler.Client.Components.Cases
@* @using EvictionFiler.Client.Jwt *@
@attribute [Authorize]

<PageTitle> Calender - Housing Court Filer</PageTitle>
@inject ICaseTypeRepository CaseTypeRepository
@inject ITenantService _tenantService
@inject ILegalCaseService LegalCaseService
@inject IRemainderTypeRepository RemainderTypeRepository

@inject IRemianderCenterService RemianderCenterService
@using EvictionFiler.Client.SpinnerService
@using EvictionFiler.Domian.Enums
@inject IJSRuntime JS
@inject NavigationManager Navigation
@inject SpinnerService spinnerservice
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization;
@using EvictionFiler.Domain.Entities

@using System.Security.Claims
@inject AuthenticationStateProvider _authStateProvider

<style>
    /* ===== EvictionFiler Light Theme (cards + rounded + blue/yellow accents) ===== */
    :root {
        --bg: #f5f7fb;
        --card: #ffffff;
        --ink: #0e1726;
        --muted: #5c6a82;
        --line: #e5eaf3;
        --chip: #f1f4fa;
        --accent: #2463eb; /* blue */
        --accent-2: #0ea5e9; /* teal-blue */
        --accent-ink: #0b1a34;
        --warn: #f5b500; /* golden */
        --good: #16a34a;
        --shadow: 0 2px 10px rgba(8, 15, 35, .06);
        --radius: 16px;
    }

    * {
        box-sizing: border-box
    }

    html,
    body {
        height: 100%
    }

    body {
        margin: 0;
        background: var(--bg);
        color: var(--ink);
        font: 500 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    .wrap {
        max-width: 1280px;
        margin: auto;
        padding: 22px
    }

    /* Top bar */
    header {
        display: flex;
        gap: 14px;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        margin: 4px 0 16px
    }

    .brand {
        display: flex;
        align-items: center;
        gap: 12px
    }

    .logo {
        width: 34px;
        height: 34px;
        border-radius: 8px;
        background: linear-gradient(135deg, #0b3a91, #2b6be6)
    }

    h1 {
        font-size: 20px;
        margin: 0
    }

    .sub {
        color: var(--muted)
    }

    /* Search bar*/

    .search-box {
        width: 100%;
        padding-right: 3rem; /* space for the button */
        padding-left: 1rem;
        /* border-radius: 1.5rem; */
        /*        border: 2px solid #020336;*/
        /*background-color: #FFF;*/ /* dark background */
        color: black;
        height: 2.5rem;
        font-size: 14px;
    }

        .search-box::placeholder {
            color: darkgrey;
        }

        .search-box:focus {
            border: 2px solid #020336 !important;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
            background: #F5F5F5;
        }

    .search-notes {
        width: 100%;
        padding-right: 3rem; /* space for the button */
        padding-left: 1rem;
        color: black;
        font-size: 14px;
    }

        .search-notes::placeholder {
            color: darkgrey;
        }

        .search-notes:focus {
            border: 2px solid #020336 !important;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
            background: #F5F5F5;
        }

/*    .modal {
        display: block !important;
        background: rgba(0,0,0,0.6);
        position: fixed;
        inset: 0;
        z-index: 1050;
    }

    .modal-dialog {
        margin: 10% auto !important;
        z-index: 1051;
    }
*/
    /*    .search-btn {
        position: absolute;
        right: 0.7rem;
        top: 50%;
        transform: translateY(-50%);
        border: none;
        background: none;
        color: #020336;
        cursor: pointer;
        padding: 0;
        font-size: 1.2rem;
    }

        .search-btn:hover {
            color: #1F365D;
        }*/

    /* Card */
    .card {
        background: var(--card);
        border: 1px solid var(--line);
        border-radius: var(--radius);
        box-shadow: var(--shadow)
    }

    .card-head {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 14px;
        border-bottom: 1px solid var(--line);
        background: #fbfdff;
        border-top-left-radius: var(--radius);
        border-top-right-radius: var(--radius);
        color: #3b4a66
    }

    .card-body {
        padding: 14px
    }

    /* Filters */
    .panel .filters {
        display: grid;
        grid-template-columns: repeat(6, minmax(170px, 1fr));
        gap: 12px
    }

    .control label {
        display: block;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: .06em;
        color: var(--muted);
        margin: 2px 0 6px
    }

    .control input,
    .control select {
        width: 100%;
        background: #fff;
        color: var(--ink);
        border: 1px solid var(--line);
        border-radius: 12px;
        padding: 10px 12px;
        outline: none;
        box-shadow: 0 1px 0 rgba(10, 20, 40, .02);
    }

        .control input:focus,
        .control select:focus {
            border-color: #cdd7ee;
            box-shadow: 0 0 0 3px rgba(36, 99, 235, .08)
        }

    /* Buttons */
    .bar {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
        margin-top: 12px
    }
    .btn:hover {
        color: white !important;
    }

    .btn {
        background: var(--accent);
        color: #fff;
        border: 0;
        border-radius: 12px;
        padding: 10px 14px;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(36, 99, 235, .22);
        border: 1px solid #d1d5db;
    }

        .btn.secondary {
            background: #fff;
            color: var(--accent-ink);
            border: 1px solid var(--line);
            box-shadow: none
        }

        .btn.ghost {
            background: var(--chip);
            color: var(--accent-ink);
            border: 1px dashed var(--line);
            box-shadow: none
        }

    .badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: #fff;
        border: 1px solid var(--line);
        padding: 8px 10px;
        border-radius: 12px;
        color: var(--muted)
    }

    /* Stats */
    .stats {
        display: flex;
        gap: 12px;
        flex-wrap: wrap
    }

    .stat {
        display: flex;
        align-items: center;
        gap: 10px;
        background: #fff;
        border: 1px solid var(--line);
        border-radius: 12px;
        padding: 8px 12px;
        color: var(--muted);
        box-shadow: var(--shadow)
    }

        .stat b {
            color: var(--ink)
        }

    /* Table */
    .table-wrap {
        overflow: auto;
        max-height: 70vh
    }

    .table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0
    }

        .table thead th {
            position: sticky;
            top: 0;
            background: #fbfdff;
            color: #7383a1;
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid var(--line);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: .06em;
        }

        .table tbody td {
            padding: 12px;
            border-bottom: 1px solid var(--line);
            vertical-align: top
        }

    .caption {
        font-weight: 700
    }

    .label {
        display: inline-block;
        padding: 3px 10px;
        border-radius: 999px;
        font-size: 12px;
        background: #fff5d6;
        color: #8a6400;
        border: 1px solid #ffe9a3
    }

        .label.holdover {
            background: #e8f0ff;
            color: #153e91;
            border-color: #d7e5ff
        }

        .label.np {
            background: #e6fbff;
            color: #055d66;
            border-color: #c8f5ff
        }

    /* Responsive */
    @@media (max-width:1100px) {
        .panel .filters {
            grid-template-columns: repeat(3, minmax(170px, 1fr))
        }
    }

    @@media (max-width:640px) {
        .panel .filters {
            grid-template-columns: 1fr
        }

        .table .hide-sm {
            display: none
        }
    }

    /* Print */
    @@media print {
        body {
            background: #fff;
            color: #000
        }

        header,
        .panel .bar .btn.secondary,
        .panel .bar .btn.ghost {
            display: none !important
        }

        .wrap {
            max-width: none;
            padding: 0
        }

        .card {
            border: 0;
            box-shadow: none
        }

        .table thead th {
            background: #fff;
            color: #000;
            border-color: #ccc
        }

        .table tbody td {
            border-color: #ddd
        }

        .label {
            border-color: #ccc;
            background: #fff;
            color: #000
        }
    }

    /* Optional strict 5 rows per page */
    @@media print {
        body .per5 .table tbody tr {
            page-break-inside: avoid
        }

            body.per5 .table tbody tr:nth-child(5n) {
                page-break-after: always
            }
    }
</style>

<div class="wrap">

    <!-- Filters -->
    <section class="card panel p-3">
        <h2 style="font-size:16px; font-weight: 700"> Reminders Center</h2>
        <div class="card-body">
            <EditForm EditContext="_editContext" OnValidSubmit="SubmitAsync">
                <DataAnnotationsValidator />
                <div class="row g-3">

                    <div class="col-md-4 position-relative" @onfocusout="HideCaseDropDown">
                        <label class="form-label  required-label">Case<span class="text-danger">*</span></label>
                        <div class="position-relative">
                            <InputText type="text" class="form-control  search-box"
                                       placeholder="Search Case"
                                       @bind-value="searchCaseText"
                                       @oninput="OnSearchCaseInput" @onclick="ShowAllCase" />
                            <i class="fa fa-search"
                               style="position:absolute; right:15px; top:50%; transform:translateY(-50%); color:#1F365D; font-size:19.2px"></i>
                        </div>
                        @if (filteredCase?.Any() == true)
                        {
                            <ul class="dropdown-menu show" style="position: absolute; width:94% !important; cursor:pointer;">
                                @foreach (var c in filteredCase)
                                {
                                    <li class="dropdown-item" @onclick="() => SelectedCase(c)">
                                        @c.Casecode
                                    </li>
                                }
                            </ul>
                        }

                        <ValidationMessage For="() => remainderDto.CaseId" />
                    </div>


                    <div class="col-md-4">
                        <label for="f-part" class="form-label">County<span class="text-danger">*</span></label>
                        <InputSelect class="form-select search-box" @bind-Value="remainderDto.CountyId">
                            <option value="">-- Select --</option>
                            @foreach (var l in CountyList)
                            {
                                <option value="@l.Id">@l.Name</option>
                            }
                        </InputSelect>
                        <ValidationMessage For="@(()=>remainderDto.CountyId)" />
                    </div>
                    <div class="col-md-4 position-relative" @onfocusout="HideTenantDropDown">
                        <label class="form-label  required-label">Tenant<span class="text-danger">*</span></label>
                        <InputText type="text" class="form-control search-box"
                                   placeholder="Search tenant name"
                                   @bind-value="searchTenantText"
                                   @oninput="OnSearchTenantInput" @onclick="ShowAllTenant" />
                        @if (filteredTenant?.Any() == true)
                        {
                            <ul class="dropdown-menu show" style="position: absolute; width:94% !important; cursor:pointer;">
                                @foreach (var c in filteredTenant)
                                {
                                    <li class="dropdown-item" @onclick="() => SelectedTenant(c)">
                                        @c.FirstName @c.LastName
                                    </li>
                                }
                            </ul>
                        }
                        <ValidationMessage For="@(() => remainderDto.TenantId)" />
                    </div>
                </div>

                <div class="row mt-2 g-3">
                    <div class="col-md-4">
                        <label for="f-index" class="form-label">Index</label>
                        <InputText id="f-from" class="form-control search-box" placeholder="Enter Index" @bind-Value="remainderDto.Index" />
                    </div>
                    <div class="col-md-4">
                        <label for="f-part" class="form-label">Type<span class="text-danger">*</span></label>
                        <InputSelect class="form-select search-box" @bind-Value="remainderDto.RemainderTypeId">
                            <option value="">-- Select --</option>
                            @foreach (var l in RemainderTypeList)
                            {
                                <option value="@l.Id">@l.Name</option>
                            }
                        </InputSelect>
                        <ValidationMessage For="@(()=>remainderDto.RemainderTypeId)" />
                    </div>
                    <div class="col-md-4">
                        <label class="form-label  required-label">When</label>
                        <input type="datetime-local" class="form-control search-box"
                               placeholder="mm/dd/yyyy --:-- --"
                               @bind-value="remainderDto.When" />

                    </div>
                </div>

                <div class="row mt-2 p-0 ms-0 me-0">

                    <label class="form-label p-0">Note</label>
                    <InputTextArea class="form-control search-notes" rows="3" placeholder="Write notes" @bind-Value="remainderDto.Notes"></InputTextArea>

                </div>
                <div class="row">
                    <div class="col-12">

                        <button class=" btn btn-primary m-2 ms-0" style="padding:4px 8px ; border-radius:10px ; font-size:12px" id="rcAdd" type="submit">Add Reminder</button>
                        <button class=" m-2 ms-0" style="padding:4px 6px ; border-radius:10px; background-color:#f3f4f6 ; font-size:13px;border: 1px solid #cac6c6">Export .ics</button>


                    </div>
                </div>


            </EditForm>
        </div>
    </section>


    <!-- Results -->
    <section class="card" style="margin-top:14px">
        <div class="d-flex justify-content-between align-items-center m-3">
            <h2 style="margin:0;font-size:1rem;font-weight:700">All Reminders</h2>
            <button type="button" style="padding:6px 8px; border-radius:10px; background-color:#f3f4f6;font-size:13px ;border: 1px solid #cac6c6;" id="" @onclick="ShowClearModal">Clear All</button>
        </div>
        <div class="card-body table-wrap">
            <table class="table" id="table">
                <thead>
                    <tr>
                        <th>When</th>
                        <th>Case</th>
                        <th>County</th>
                        <th>Type</th>
                        <th>Note</th>
                        <th>Demo Actions</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="tbody" style="font-size:11px">
                    @if (Remiandercenters != null && Remiandercenters.Any())
                    {
                        foreach (var c in Remiandercenters)
                        {
                            <tr>
                                <td>@c.When</td>
                                <td>@c.CaseCode</td>
                                <td>@c.CountyName</td>
                                <td>@c.RemainderTypeName</td>
                                <td>@c.Notes</td>
                                <td>
                                    <button class=" m-2 ms-0" style="padding:4px 6px ; border-radius:10px; background-color:#f3f4f6 ; font-size:13px;border: 1px solid #cac6c6">Demo Push</button>
                                    <button class=" m-2 ms-0" style="padding:4px 6px ; border-radius:10px; background-color:#f3f4f6 ; font-size:13px;border: 1px solid #cac6c6">Demo Email</button>
                                    <button class=" m-2 ms-0" style="padding:4px 6px ; border-radius:10px; background-color:#f3f4f6 ; font-size:13px;border: 1px solid #cac6c6">Demo Done</button>
                                </td>
                                <td class="sticky">
                                    <button class=" m-2 ms-0" @onclick=" ()=>ConfirmDelete(c.Id)" style="padding:4px 6px ; border-radius:10px; background-color:#f3f4f6 ; font-size:13px;border: 1px solid #cac6c6">Delete</button>




                                </td>

                            </tr>
                        }
                    }
                    else
                    {
                        <tr><td colspan="10" class="text-center">No data available</td></tr>
                    }
                </tbody>

            </table>
        </div>
    </section>
</div>


<!--------------------------------------Modals---------------------------------------------------->

@if (showClearModal)
{
    <div class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header  text-white" style="background-color: #1F365D;">
                    <h5 class="modal-title">Clear All Reminders</h5>
                    <button type="button" class="btn-close btn-close-white"" data-bs-dismiss="modal" @onclick ="CloseModal"></button>
                </div>
                <div class="modal-body">
                    <p class="fw-semibold mb-2">Are you sure you want to clear all reminders ?</p>
                </div>
                <div class="modal-footer">
                    @*<button type="button" class="btn btn-secondary" @onclick="CloseModal">Close</button>*@
                    <button type="button" class="btn"  style="background-color:#1F365D; border-color:#1F365D"@onclick="ClearAll">Clear</button>
                </div>
            </div>
        </div>
    </div>
}


@if (showDeleteModal)
{
    <div class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header  text-white" style="background-color: #1F365D;">
                    <h5 class="modal-title">Delete Reminders</h5>
                    <button type="button" class="btn-close btn-close-white"" data-bs-dismiss="modal" @onclick="CloseDeleteModal"></button>
                </div>
                <div class="modal-body">
                    <p class="fw-semibold mb-2">Are you sure you want to delete this reminder?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class=" btn " style="background-color:#1F365D; border-color:#1F365D" @onclick="ConfirmDelete">Delete</button>
                </div>
            </div>
        </div>
    </div>
}


@code {

    private EditToRemainderCenterDto remainderDto = new EditToRemainderCenterDto();
    private EditContext _editContext;
    private ValidationMessageStore _messages;
    private List<RemainderType> RemainderTypeList = new();
    private List<County> CountyList = new();

    private string? loggedInUserId;
    private bool isAdmin = false;
    private EditToTenantDto selectedtenant;
    private IntakeModel selectedCase;
    private List<EditToRemainderCenterDto> Remiandercenters { get; set; }

    private string searchTenantText;
    private string searchCaseText;
    private CancellationTokenSource _cts;
    private List<EditToTenantDto> filteredTenant = new();
    private List<IntakeModel> filteredCase = new();


    private bool showClearModal = false;
    private bool showDeleteModal = false;
    private Guid deleteId;

    protected override async Task OnInitializedAsync()
    {
        remainderDto = new EditToRemainderCenterDto();

        _editContext = new EditContext(remainderDto);
        _messages = new ValidationMessageStore(_editContext);


        RemainderTypeList = await RemainderTypeRepository.GetAllRemainderTypes();

        CountyList = await CaseTypeRepository.GetAllCounty();


        var authState = await _authStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        if (user.Identity != null && user.Identity.IsAuthenticated)
        {
            loggedInUserId = user.Claims.FirstOrDefault(c => c.Type == ClaimTypes.NameIdentifier)?.Value;
            isAdmin = user.Claims.Any(c => c.Type == ClaimTypes.Role && c.Value == "Admin");
        }

        Remiandercenters = await RemianderCenterService.GetAllRemainderCenterAsync();
    }

    private async Task ShowClearModal()
    {
        showClearModal = true;

        await InvokeAsync(StateHasChanged);

    }

    private async Task CloseModal()
    {
        showClearModal = false;
        await InvokeAsync(StateHasChanged);

    }
    private async Task ClearAll()
    {
        spinnerservice.Show();


        await Task.Delay(300);

        bool isclear = await RemianderCenterService.DeleteAllRemainderAsync();
        if (isclear)
        {
            Remiandercenters.Clear();

        }

        showClearModal = false;

        spinnerservice.Hide();

        await InvokeAsync(StateHasChanged);
    }


    private async void SelectedTenant(EditToTenantDto tenant)
    {

        selectedtenant = tenant;
        searchTenantText = tenant.FirstName!;

        remainderDto.TenantId = tenant.Id;

        _editContext.NotifyFieldChanged(new FieldIdentifier(remainderDto, nameof(remainderDto.TenantId)));

        filteredTenant?.Clear();


        StateHasChanged();


    }

    private async Task SelectedCase(IntakeModel selected)

    {
        selectedCase = selected;
        searchCaseText = selected.Casecode ?? string.Empty;
        remainderDto.CaseId = selected.Id;


        _editContext.NotifyFieldChanged(new FieldIdentifier(remainderDto, nameof(remainderDto.CaseId)));

        // Agar filteredCase null nahi hai to clear kar do
        filteredCase?.Clear();
        // UI refresh
        await InvokeAsync(StateHasChanged);
    }

    private async Task OnSearchCaseInput(ChangeEventArgs e)
    {
        searchCaseText = e.Value?.ToString() ?? "";
        _cts?.Cancel();
        _cts = new CancellationTokenSource();
        try
        {

            await Task.Delay(300, _cts.Token);
            // ⭐ Empty input → load all tenants (ONLY here)
            if (string.IsNullOrWhiteSpace(searchCaseText))
            {
                await ShowAllCase();
                return;
            }

            // ⭐ 1st & 2nd character → DO NOTHING (keep list unchanged)
            if (searchCaseText.Length < 3)
            {
                // ❗ No reload here (important)
                return;
            }

            else
            {
                // ⭐ 3+ characters → server search
                filteredCase = await LegalCaseService.SearchCasebyCode(searchCaseText);
            }

        }
        catch (TaskCanceledException)
        {
            // Old task cancelled → ignore
        }

    }


    private async Task OnSearchTenantInput(ChangeEventArgs e)
    {
        searchTenantText = e.Value?.ToString() ?? "";
        _cts?.Cancel();
        _cts = new CancellationTokenSource();
        try
        {

            await Task.Delay(300, _cts.Token);
            // ⭐ Empty input → load all tenants (ONLY here)
            if (string.IsNullOrWhiteSpace(searchTenantText))
            {
                await ShowAllTenant();
                return;
            }

            // ⭐ 1st & 2nd character → DO NOTHING (keep list unchanged)
            if (searchTenantText.Length < 3)
            {
                // ❗ No reload here (important)
                return;
            }

            else
            {
                // ⭐ 3+ characters → server search
                filteredTenant = await _tenantService.SearchTenantbyname(searchTenantText);
            }

        }
        catch (TaskCanceledException)
        {
            // Old task cancelled → ignore
        }

    }

    private async Task ShowAllTenant()
    {

        filteredTenant = await _tenantService.GetAlltenant();

    }

    private async Task ShowAllCase()
    {

        filteredCase = await LegalCaseService.GetAllCase();

    }

    async Task HideCaseDropDown(FocusEventArgs e)
    {
        // Small delay to allow click on dropdown item to register before hiding
        await Task.Delay(500);
        if (filteredCase.Any())
        {
            filteredCase.Clear();

        }
        StateHasChanged();
    }

    async Task HideTenantDropDown(FocusEventArgs e)
    {
        // Small delay to allow click on dropdown item to register before hiding
        await Task.Delay(500);
        if (filteredTenant.Any())
        {
            filteredTenant.Clear();

        }
        StateHasChanged();
    }

    private async Task SubmitAsync()
    {
        spinnerservice.Show();
        if (remainderDto == null)
            return;


        var authState = await _authStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        var userIdClaim = user.Claims.FirstOrDefault(c => c.Type == ClaimTypes.NameIdentifier)?.Value;

        if (!string.IsNullOrEmpty(userIdClaim) && Guid.TryParse(userIdClaim, out Guid userGuid))
        {
            remainderDto.CreatedBy = userGuid;
        }
        else
        {
            // unauthenticated user
            remainderDto.CreatedBy = Guid.Empty;
        }

        // Save the full nested object
        var isSaved = await RemianderCenterService.Create(remainderDto);
        if (isSaved)
        {
            //spinnerservice.Show();
            Navigation.NavigateTo("/remainder-center", true);
        }
    }

    private void ConfirmDelete(Guid id)
    {
        deleteId = id;
        showDeleteModal = true;
    }
    private void CloseDeleteModal()
    {
        showDeleteModal = false;
    }
    private async Task ConfirmDelete()
    {
        showDeleteModal = false;
        await Deleteremainer(deleteId);
    }



    public async Task Deleteremainer(Guid id)
    {
        spinnerservice.Show();

        await Task.Delay(300);

        bool isDeleted = await RemianderCenterService.DeleteRemainderCenterAsync(id);

        if (isDeleted)
        {

            Remiandercenters = await RemianderCenterService.GetAllRemainderCenterAsync();
            StateHasChanged();
        }

        showClearModal = false;

        spinnerservice.Hide();

        await InvokeAsync(StateHasChanged);
    }


}




